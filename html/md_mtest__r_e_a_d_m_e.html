<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MuseScore-2.2: Building &amp; running the tests</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MuseScore-2.2
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('md_mtest__r_e_a_d_m_e.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Building &amp; running the tests </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>To build all tests:</p>
<table class="doxtable">
<tr>
<th>Linux </th><th>OSX </th><th>Windows  </th></tr>
<tr>
<td>make debug<br />
sudo make installdebug<br />
cd build.debug/mtest<br />
make </td><td>make -f Makefile.osx debug<br />
make -f Makefile.osx installdebug<br />
cd build.debug/mtest<br />
make -f Makefile.osx </td><td>mingw32-make -f Makefile.mingw debug<br />
mingw32-make -f Makefile.mingw installdebug<br />
cd build.debug<br />
mingw32-make -f Makefile.mingw </td></tr>
</table>
<p>To run all tests: </p><pre class="fragment">ctest
</pre><p>To run only one test (for debugging purposes): </p><pre class="fragment">cd libmscore/join/
./tst_join
</pre><p>To see how the CI environment is doing it check <code>.travis.yml</code> and <code>build/run_tests.sh</code></p>
<p><b>Note: You need to have <code>diff</code> in your path. For Windows, get a copy of <a href="http://gnuwin32.sourceforge.net/packages/diffutils.htm" title="diffutils for Windows">diffutils for Windows</a>.</b></p>
<h1>Test case conventions </h1>
<p>Tests are grouped in directories by feature (like libmscore or mxl). In these directories, each subdirectory represents a test suite for a particular sub feature.</p>
<p>The name of a test suite directory should be descriptive. The CPP file for the tests should use the same name as the directory, for example <code>tst_foo.cpp</code> in directory <code>foo</code>. It's good practice to include a README file in a test suite directory.</p>
<p>Test suite CPP files contain one slot per test case. Each file should be called foo-XX with XX being an incrementing count. If a test case uses a file and a ref file, they should be called <code>foo-XX</code> and <code>foo-XX-ref</code>, with the extension .mscx. A test case should not reuse a file from another test case.</p>
<p>To create reference or original files, MuseScore can be run with the <code>-t</code> command line argument and it will save all the files in the session in test mode. Such files do not contain platform or version information and do contain extra data for tracing (for example, they contains pixel level position for beams).</p>
<h1>How to write a test case </h1>
<h2>Import test </h2>
<ul>
<li>Open a short file containing an individual case in one of the formats supported by MuseScore</li>
<li>Save in MuseScore format</li>
<li>Compare with reference file</li>
</ul>
<p>At first the test will fail because there is no reference file. Open the file created by the test case in MuseScore and try to edit it to be sure it's valid. If the file is valid, save it (without version number) as a reference file.</p>
<h2><a class="el" href="class_object.html">Object</a> read write </h2>
<p>Create a test case for all elements and all properties in each element. See <code>libmscore/note</code></p>
<ul>
<li>Create an object</li>
<li>Set a property</li>
<li>Write and read the object</li>
<li>Check if the property has the right value</li>
</ul>
<h2>Action tests </h2>
<p>See <code>libmscore/join</code> or <code>libmscore/split</code> for example</p>
<ul>
<li>Read a score file</li>
<li>Apply an action</li>
<li>Write the file</li>
<li>Compare with a reference</li>
<li>(Undo the action)</li>
<li>(Compare with original file)</li>
</ul>
<h2>Compatibility tests </h2>
<p>Most of them are in <code>mtest/libmscore/compat</code></p>
<ul>
<li>Read a score file from an older version of MuseScore</li>
<li>Write the file</li>
<li>Compare with a reference file </li>
</ul>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
